<!DOCTYPE html>
<html>
<head>
    <title>VeganCheck API Integration</title>
</head>
<body>
    <h1>VeganCheck API Integration</h1>
    <form onsubmit="event.preventDefault(); scanBarcode();">
    <label for="barcodeInput">Enter Product Name or Barcode:</label>
    <input type="text" id="barcodeInput" required>
    <button type="submit">Search</button>
    </form>
    <div id="result"></div>

    <script>
        async function scanBarcode() {
            const barcode = document.getElementById('barcodeInput').value;
            const apiUrl = `https://api.vegancheck.me/v0/product/${barcode}`;
        if (!barcodeInput) {
            console.error('Barcode element not found.');
            return;
        }
            try {
                let response = await fetch(apiUrl, { method: "POST" });
                let data = await response.json();
                displayResult(data);
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }
        
    function displayResult(data) {
        const resultDiv = document.getElementById('result');
        resultDiv.innerHTML = '';

        if (data.status === 200 && data.product) {
            const productName = data.product.productname;
            const isVegan = data.product.vegan === "true";

            let resultText = `<h2>${productName}</h2>`;
            resultText += '<ul>';

            // Loop through the product object and display each category and its value
            for (const category in data.product) {
                const value = data.product[category];
                resultText += `<li><strong>${category}:</strong> ${value}</li>`;
            }

            resultText += '</ul>';
            resultDiv.innerHTML = resultText;
        } else {
            resultDiv.innerText = 'Product not found or an error occurred.';
        }
    }
    </script>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>